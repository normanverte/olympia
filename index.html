<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Olympic Scoreboard</title>
  <style>
    body {
      margin: 0;
      background: transparent;
      font-family: 'Segoe UI', sans-serif;
      color: white;
    }

    #score-wrapper {
      position: fixed;
      bottom: 5%;
      left: 50%;
      transform: translateX(-50%) translateY(30%);
      opacity: 0;
      animation: slideFadeIn 1.5s ease-out forwards;
    }

    @keyframes slideFadeIn {
      to {
        transform: translateX(-50%) translateY(0%);
        opacity: 1;
      }
    }

    .scoreboard {
      display: flex;
      gap: 60px;
      justify-content: center;
    }

    .column {
      display: flex;
      flex-direction: column;
    }

    .entry {
      display: flex;
      align-items: center;
      margin: 6px 0;
      font-size: 1.3em;
      white-space: nowrap;
    }

    .medal {
      width: 1.8em;
      text-align: center;
      margin-right: 0.5em;
    }

    .flag {
      font-size: 1.3em;
      margin-right: 0.4em;
    }

    .score {
      margin-left: auto;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="score-wrapper">
    <div class="scoreboard" id="scoreboard"></div>
  </div>

  <script>
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS6x3HikLShNLoJXDK7ZCYOIk4bsZDwBwbuZJgg2DD4h3ZvW4fXPR2u4-Grg4BmFxWE5oRpUgCmb3ek/pub?gid=1358986165&single=true&output=csv";

    const countryFlags = {
      "Eesti": "ðŸ‡ªðŸ‡ª",
      "Soome": "ðŸ‡«ðŸ‡®",
      "LÃ¤ti": "ðŸ‡±ðŸ‡»",
      "Rootsi": "ðŸ‡¸ðŸ‡ª",
      "Taani": "ðŸ‡©ðŸ‡°",
      "Saksamaa": "ðŸ‡©ðŸ‡ª",
      "Prantsusmaa": "ðŸ‡«ðŸ‡·",
      "Portugal": "ðŸ‡µðŸ‡¹",
      "Jaapan": "ðŸ‡¯ðŸ‡µ",
      "Austraalia": "ðŸ‡¦ðŸ‡º",
      "Tansaania": "ðŸ‡¹ðŸ‡¿",
      "Uganda": "ðŸ‡ºðŸ‡¬",
      "Singapur": "ðŸ‡¸ðŸ‡¬",
      "Tai": "ðŸ‡¹ðŸ‡­",
      "TÅ¡iili": "ðŸ‡¨ðŸ‡±",
      "LÃµuna-Korea": "ðŸ‡°ðŸ‡·",
      "Jamaica": "ðŸ‡¯ðŸ‡²",
      "LÃµuna-Aafrika Vabariik": "ðŸ‡¿ðŸ‡¦",
      "Kanada": "ðŸ‡¨ðŸ‡¦",
      "Mehhiko": "ðŸ‡²ðŸ‡½",
      "Brasiilia": "ðŸ‡§ðŸ‡·",
      "Uus-Meremaa": "ðŸ‡³ðŸ‡¿",
      "Kiribati": "ðŸ‡°ðŸ‡®",
      "FidÅ¾i": "ðŸ‡«ðŸ‡¯",
      "Paapua Uus-Guinea": "ðŸ‡µðŸ‡¬",
      "Costa Rica": "ðŸ‡¨ðŸ‡·",
      "India": "ðŸ‡®ðŸ‡³",
      "Holland": "ðŸ‡³ðŸ‡±",
      "Gruusia": "ðŸ‡¬ðŸ‡ª",
      "Kreeka": "ðŸ‡¬ðŸ‡·",
      "Madagaskar": "ðŸ‡²ðŸ‡¬"
    };

    function getMedal(index) {
      return index === 0 ? "ðŸ¥‡" :
             index === 1 ? "ðŸ¥ˆ" :
             index === 2 ? "ðŸ¥‰" : `${index + 1}.`;
    }

    fetch(csvUrl)
      .then(res => res.text())
      .then(text => {
        const rows = text.trim().split("\n").map(r => r.split(","));
        const data = rows
          .map(row => ({
            country: row[0]?.trim(),
            score: parseInt(row[9]) || 0
          }))
          .filter(row => row.country && !isNaN(row.score))
          .sort((a, b) => b.score - a.score);

        const half = Math.ceil(data.length / 2);
        const left = data.slice(0, half);
        const right = data.slice(half);

        const createColumn = (items, offset = 0) => {
          return `
            <div class="column">
              ${items.map((row, i) => `
                <div class="entry">
                  <div class="medal">${getMedal(i + offset)}</div>
                  <div class="flag">${countryFlags[row.country] || ""}</div>
                  <div>${row.country}</div>
                  <div class="score">${row.score}</div>
                </div>
              `).join('')}
            </div>
          `;
        };

        document.getElementById("scoreboard").innerHTML =
          createColumn(left, 0) + createColumn(right, half);
      });
  </script>
</body>
</html>
